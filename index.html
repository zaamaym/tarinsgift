<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Barakallahu Fii Umrik Teh Arin ðŸŒ»</title>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        :root {
            --bg-color: #F2F2F7;
            --card-bg: rgba(255, 255, 255, 0.75);
            --text-main: #1C1C1E;
            --text-muted: #8E8E93;
            --accent: #FF9500;
        }

        * { 
            box-sizing: border-box; 
            margin: 0; 
            padding: 0; 
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
            -webkit-touch-callout: none;
        }

        body {
            background-color: var(--bg-color);
            font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", sans-serif;
            color: var(--text-main);
            overflow-x: hidden;
            position: relative;
            min-height: 100vh;
        }

        #flash-overlay {
            position: fixed; inset: 0;
            background: white;
            z-index: 999;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.4s ease-out;
        }

        #envelope-screen {
            position: fixed; inset: 0;
            background: rgba(242, 242, 247, 0.85);
            backdrop-filter: blur(25px);
            -webkit-backdrop-filter: blur(25px);
            z-index: 100;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            transition: opacity 0.8s cubic-bezier(0.16, 1, 0.3, 1), transform 0.8s cubic-bezier(0.16, 1, 0.3, 1);
        }

        @keyframes attentionShake {
            0%, 20%, 100% { transform: scale(1) rotate(0deg); }
            5% { transform: scale(1.05) rotate(-3deg); }
            10% { transform: scale(1.05) rotate(3deg); }
            15% { transform: scale(1.05) rotate(-3deg); }
        }

        .envelope-btn {
            background: rgba(255, 255, 255, 0.95);
            border: 1px solid rgba(255, 255, 255, 0.8);
            border-radius: 28px; padding: 40px;
            box-shadow: 0 20px 40px rgba(255, 149, 0, 0.15);
            text-align: center; cursor: pointer;
            animation: attentionShake 3s infinite;
            transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1), box-shadow 0.3s;
        }

        .envelope-btn:hover { 
            animation-play-state: paused;
            box-shadow: 0 25px 50px rgba(255, 149, 0, 0.25); 
            transform: translateY(-5px) scale(1.02);
        }
        
        .envelope-icon { font-size: 5.5rem; line-height: 1; margin-bottom: 15px; display: block; filter: drop-shadow(0 4px 8px rgba(255, 149, 0, 0.2)); }
        .envelope-text { font-size: 1.2rem; font-weight: 700; color: #1C1C1E; }
        .envelope-sub { font-size: 0.9rem; color: var(--text-muted); margin-top: 6px; font-weight: 500;}

        #main-screen {
            display: none; 
            opacity: 0;
            transform: translateY(40px);
            filter: blur(10px);
            justify-content: center; align-items: center;
            padding: 40px 20px 40px 20px;
            min-height: 100vh;
            transition: opacity 0.8s ease-out, transform 0.8s cubic-bezier(0.16, 1, 0.3, 1), filter 0.8s ease-out;
        }

        .ambient-bg {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            z-index: -1; background: #F2F2F7; overflow: hidden; pointer-events: none;
        }
        
        .blob-1, .blob-2 {
            position: absolute; border-radius: 50%; filter: blur(80px); opacity: 0.6;
            animation: floatBlob 12s infinite alternate ease-in-out;
        }
        .blob-1 { width: 300px; height: 300px; background: #FFD60A; top: -10%; left: -10%; }
        .blob-2 { width: 400px; height: 400px; background: #FF9500; bottom: -20%; right: -10%; animation-delay: -5s; }

        @keyframes floatBlob {
            0% { transform: translate(0, 0) scale(1); }
            100% { transform: translate(50px, 50px) scale(1.1); }
        }

        .sunflower-bg {
            position: fixed; font-size: 3rem; opacity: 0.4; filter: blur(1px);
            animation: floatUp 15s linear infinite; z-index: 0; pointer-events: none;
        }
        .sf-1 { left: 10%; animation-duration: 18s; }
        .sf-2 { left: 80%; animation-duration: 14s; font-size: 4rem; animation-delay: 2s; }
        .sf-3 { left: 50%; animation-duration: 20s; opacity: 0.2; font-size: 5rem; animation-delay: 5s; filter: blur(3px); }

        @keyframes floatUp {
            0% { transform: translateY(100vh); }
            100% { transform: translateY(-20vh); }
        }

        .app-container { max-width: 440px; width: 100%; display: flex; flex-direction: column; gap: 20px; z-index: 10; position: relative; }
        .header { text-align: center; }
        .date { font-size: 0.85rem; font-weight: 700; color: var(--accent); text-transform: uppercase; letter-spacing: 2px; display: block; margin-bottom: 8px; }
        h1 { font-size: 2.2rem; font-weight: 800; letter-spacing: -0.5px; color: #1C1C1E; }

        .photo-widget { 
            background: #ffffff; 
            border-radius: 28px; 
            padding: 12px; 
            box-shadow: 0 15px 35px rgba(255, 149, 0, 0.1); 
            position: relative; 
        }
        .photo-widget img { 
            width: 100%; 
            height: 350px; 
            object-fit: cover; 
            border-radius: 18px; 
            display: block;
            pointer-events: none; 
        }

        .tags { display: flex; gap: 8px; flex-wrap: wrap; padding: 0 4px; justify-content: center;}
        .tag { background: rgba(255, 149, 0, 0.15); color: #CC7700; padding: 6px 16px; border-radius: 20px; font-size: 0.85rem; font-weight: 600; }

        .message-card {
            background: var(--card-bg); backdrop-filter: blur(25px); -webkit-backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.6); border-radius: 28px; padding: 30px;
            box-shadow: 0 8px 32px rgba(255, 149, 0, 0.1);
        }
        .message-card p { font-size: 1.05rem; line-height: 1.6; margin-bottom: 18px; color: #3A3A3C; }

        .role-highlight { background: rgba(255, 149, 0, 0.15); color: #CC7700; padding: 2px 8px; border-radius: 8px; font-weight: 600; font-size: 0.95rem; display: inline-block; margin: 2px 0; }
        .text-bold { font-weight: 700; color: #1C1C1E; }
        .text-italic { font-style: italic; color: #636366; }

        .signature { margin-top: 24px; padding-top: 20px; border-top: 1px solid rgba(0,0,0,0.05); display: flex; justify-content: space-between; align-items: center; }
        .sign-text { font-size: 0.9rem; color: var(--text-muted); }
        .sign-name { font-weight: 800; font-size: 1.3rem; color: var(--accent); }

        .btn-confetti {
            background: linear-gradient(135deg, #C42A0B, #FF9E00);
            border: none;
            border-radius: 50%;
            width: 40px; 
            height: 40px;
            font-size: 1.8rem;
            cursor: pointer;
            box-shadow: 0 8px 25px rgba(255, 149, 0, 0.4);
            transition: transform 0.2s cubic-bezier(0.34, 1.56, 0.64, 1), box-shadow 0.2s;
            display: flex; justify-content: center; align-items: center;
            position: absolute;
            bottom: 30px; 
            right: 30px;  
            z-index: 15;   
        }
        
        .btn-confetti:active { transform: scale(0.9); box-shadow: 0 4px 12px rgba(255, 149, 0, 0.2); }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20%, 60% { transform: translateX(-4px) rotate(-2deg); }
            40%, 80% { transform: translateX(4px) rotate(2deg); }
        }
        .shake-active { animation: shake 0.4s cubic-bezier(.36,.07,.19,.97) both; }

    </style>
</head>
<body>

    <audio id="bgm-audio" src="assets/sounds/bgm.mp3" loop preload="auto"></audio>
    <audio id="sfx-pop" src="assets/sounds/pop.ogg" preload="auto"></audio>
    <audio id="sfx-popper1" src="assets/sounds/party_popper1.ogg" preload="auto"></audio>
    <audio id="sfx-popper2" src="assets/sounds/party_popper2.ogg" preload="auto"></audio>
    <audio id="sfx-popper3" src="assets/sounds/party_popper3.ogg" preload="auto"></audio>

    <div id="flash-overlay"></div>

    <div class="ambient-bg">
        <div class="blob-1"></div>
        <div class="blob-2"></div>
    </div>

    <div class="sunflower-bg sf-1">ðŸŒ»</div>
    <div class="sunflower-bg sf-2">ðŸŒ»</div>
    <div class="sunflower-bg sf-3">ðŸŒ»</div>

    <div id="envelope-screen">
        <div class="envelope-btn" onclick="openLetter()" id="env-btn">
            <span class="envelope-icon" draggable="false">ðŸ’Œ</span>
            <div class="envelope-text">Surat buat Teh Arin</div>
            <div class="envelope-sub">Tap untuk membuka âœ¨</div>
        </div>
    </div>

    <div id="main-screen">
        <div class="app-container">
            
            <div class="header">
                <span class="date">Special Edition ðŸŒ»</span>
                <h1>Barakallahu Fii Umrik</h1>
            </div>

            <div class="photo-widget">
                <img src="assets/photos/tarinnamad.jpg" alt="Teh Arin" draggable="false">
                <button class="btn-confetti" onclick="playConfetti(this)">ðŸŽ‰</button>
            </div>

            <div class="tags">
                <div class="tag">ðŸŽ“ S.Pd. Biologi UNS</div>
                <div class="tag">ðŸ«‚ si sulung </div>
            </div>

            <div class="message-card">
                <p>Teruntuk <span class="text-bold">Teh Arina Ilma Mufida, S.Pd.</span></p>
                
                <p>Sebagai seorang <span class="role-highlight">Kakak Pertama</span>, Teh Arin selalu jadi garda terdepan buat kasih contoh yang baik buat adik-adiknya. </p>
                
                <p>Walau mungkin jarang terucap langsung, Amad selalu perhatiin kok perjuangan Teh Arin. <span class="text-bold">Terima kasih banyak ya, Teh.</span> Terima kasih sudah bertahan, bersabar, dan selalu nyempetin doain keluarga di setiap sujudnya.</p>
                
                <p>Di usia yang baru ini, Amad doakan semoga Allah selalu mudahkan langkah Teh Arin. <span class="text-italic">Semoga ilmu yang didapat jadi lentera, dan semoga segala lelahnya dicatat sebagai pahala yang indah.</span> Teruslah mekar dan bersinar seperti bunga matahari ini ya, Teh!</p>
                
                <p>Di usia yang baru ini, Amad doakan semoga Allah selalu mudahkan langkah Teh Arin. <span class="text-italic">Semoga ilmu yang didapat jadi lentera, dan semoga segala lelahnya dicatat sebagai pahala yang indah.</span> Teruslah mekar dan bersinar seperti bunga matahari ini ya, Teh!</p>

                <div class="signature">
                    <span class="sign-text">Dari si bungsu yang paling keren,</span>
                    <span class="sign-name">Amad</span>
                </div>
            </div>

        </div>
    </div>

    <script>
        function playSound(id) {
            const audio = document.getElementById(id);
            if(audio) {
                // KUNCI: Khusus untuk BGM, set ke detik 30 saat pertama kali dimainkan
                if (id === 'bgm-audio') {
                    if (audio.paused) {
                        audio.currentTime = 30; // Mulai di detik 30
                    }
                } else {
                    // Untuk SFX pop/popper, selalu reset ke 0 biar suaranya responsif dipencet berkali-kali
                    audio.currentTime = 0; 
                }
                audio.play().catch(e => console.log("Audio belum bisa muter: " + e));
            }
        }

        // Fungsi buat milih suara party popper secara acak
        function playRandomPopper() {
            const popperSounds = ['sfx-popper1', 'sfx-popper2', 'sfx-popper3'];
            const randomId = popperSounds[Math.floor(Math.random() * popperSounds.length)];
            playSound(randomId);
        }

        function openLetter() {
            const envelope = document.getElementById('envelope-screen');
            const mainScreen = document.getElementById('main-screen');
            const envBtn = document.getElementById('env-btn');
            const flash = document.getElementById('flash-overlay');

            // Play BGM (akan otomatis loncat ke detik 30 karena logika di playSound)
            playSound('bgm-audio');

            envBtn.style.animation = 'none';
            envBtn.style.transform = 'scale(0.9)';

            playSound('sfx-pop'); // Suara pop kecil pas awal diklik
            confetti({ particleCount: 50, spread: 60, origin: { y: 0.5 }, colors: ['#FFD60A', '#FF9500'] });

            setTimeout(() => {
                flash.style.opacity = '1';
                envelope.style.transform = 'translateY(-100px) scale(1.5)';
                envelope.style.opacity = '0';

                setTimeout(() => {
                    envelope.style.display = 'none';
                    mainScreen.style.display = 'flex';
                    flash.style.opacity = '0';

                    setTimeout(() => {
                        mainScreen.style.opacity = '1';
                        mainScreen.style.transform = 'translateY(0)';
                        mainScreen.style.filter = 'blur(0px)';
                    }, 50);

                    setTimeout(() => {
                        playRandomPopper(); // Suara popper random pas ledakan gede
                        fireConfetti();
                    }, 600);
                }, 300); 

            }, 200); 
        }

        function playConfetti(btnElement) {
            event.stopPropagation(); 
            
            btnElement.classList.add('shake-active');
            setTimeout(() => { btnElement.classList.remove('shake-active'); }, 400);
            
            playRandomPopper(); // Suara popper random pas tombol diklik
            fireConfetti();
        }

        function fireConfetti() {
            var count = 250;
            var defaults = { origin: { y: 0.6 }, colors: ['#FFD60A', '#FF9500', '#FFCC00', '#FFFFFF', '#FF3B30'] };

            function fire(particleRatio, opts) {
                confetti(Object.assign({}, defaults, opts, { particleCount: Math.floor(count * particleRatio) }));
            }

            fire(0.25, { spread: 26, startVelocity: 55 });
            fire(0.2, { spread: 60 });
            fire(0.35, { spread: 100, decay: 0.91, scalar: 0.8 });
            fire(0.1, { spread: 120, startVelocity: 25, decay: 0.92, scalar: 1.2 });
            fire(0.1, { spread: 120, startVelocity: 45 });
        }
    </script>
</body>
  </html>
  
